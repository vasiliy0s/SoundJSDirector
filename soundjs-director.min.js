/**
 * SoundJS Director v0.3.1
 * Manager for groupped and alone sounds in CreateJS/SoundJS with SoundJSDirector
 * by Vasiliy Os <talk@vasiliy0s.com>
 */
!function(a){"use strict";function b(){throw"SoundJSDirector cannot be initialized. Use 'new SoundJSDirector.Group' for manage sounds"}function c(a,d){if(!(this instanceof c))return new c(a,d);var e=arguments.length;if(1===e)switch(typeof a){case"string":d=b.extend(b._defaults),d.name=a;break;case"object":d=a,a=d.name}else if(0===e)throw"SoundJSDirector.Group there is no passed arguments";if(!a||"string"!=typeof a)throw"SoundJSDirector.Group cannot initialize new sounds group without name";this.name=a,this.options=b.extend(b.parseOptions(d),b._defaults,!0),this.sounds=[],this._playing=[],this._wait=[];var f=b.toArray(d.sounds);d.sound&&f.push(d.sound),this.add(f),b.group(this)}a.SoundJSDirector=b,b.prototype=new a.EventDispatcher,b.prototype._sendEvent=function(b){var c=new a.Event(b);this.dispatchEvent(c)},b.prototype.toString=function(){return"[SoundJSDirector]"},b.Group=b.prototype.Group=c,c.prototype=new a.EventDispatcher,c.prototype.add=function(c){var d,e=a.Sound,f=this;return c instanceof Array||(c=[c]),b.each(b.toArray(c),function(a){a="object"==typeof a?a:{src:a};var b=e.registerSound(a,a.basePath||f.get("basePath"));if(!b)throw"SoundJSDirector.Group "+this.name+" cannot register sound "+(a.id||a.src);d=e.createInstance(a.id||a.src),d&&this.join(d)},this),this},c.prototype.join=function(a){return a&&"object"==typeof a&&(a instanceof Array?b.each(a,this.join,this):b.setSoundGroup(a,this)),this},c.prototype.leave=function(a){return a instanceof Array?b.each(a,this.leave,this):"object"==typeof a&&b.unsetSoundGroup(a,this),this},c.prototype.flush=function(){return this.leave(this.sounds),this.sounds.length=0,this._playing.length=0,this._wait.length=0,this},c.prototype.eachSound=function(a,c){b.each(this.sounds,a,c||null)},c.prototype.eachPlayingSound=function(a,c){b.each(this._playing,a,c||null)},c.prototype.eachWaitSound=function(a,c){b.each(this._wait,a,c||null)},c.prototype.sound=function(a){return this.sounds[a]||null},c.prototype.exists=function(a){switch(typeof a){case"object":return this.sounds.indexOf(a)>=0;case"string":return!!this.sounds[a];default:return!1}},c.prototype.set=function(a,b){return this.options[a]=b,this},c.prototype.get=function(a){switch(a){case"name":return this.name;case"sounds":return this.sounds;default:return this.options[a]}},c.prototype.toString=function(){return"[SoundJSDirectorGroup]"},c.prototype.load=function(c){var d=a.Sound,e=this,f=[],g=0;return this.eachSound(function(a){var b=a.src;return f.indexOf(b)<0&&!d.loadComplete(a.src)?void(f[g++]=b):void 0}),g?(d.on("fileload",function h(a){var b=a.src,c=f.indexOf(b);0>c||(f.splice(c,1),f.length||(d.off("fileload",h),e.dispatchEvent("loaded")))}),"function"==typeof c&&e.on("loaded",function i(a){e.off("loaded",i),c(a)}),b.each(f,d.registerSound,d),this):this},c.prototype.setLoop=function(a){return this.set("loop",parseInt(a)||0),this},c.prototype.switchLoop=function(a){return this.set("loop",0===this.get("loop")?parseInt(a)||-1:0),this},c.prototype.getLoop=function(){return this.get("loop")},c.prototype.setMute=function(a){return this.eachSound(function(b){b.setMute(a)}),this},c.prototype.switchMute=function(){return this.eachSound(function(a){a.setMute(!a.getMute())}),this},c.prototype.setPan=function(a,c){return a=parseFloat(a)||0,this.set("pan",a),b.each(c?this.sounds:this._playing,function(a){a.setPan(this.getSoundPan(a))},this),this},c.prototype.getPan=function(){return this.get("pan")},c.prototype.getSoundPan=function(a,c){var d=0;return arguments.length<=1&&(c=b._defaults.pan),b.eachSoundGroup(a,function(a){c+=1+parseFloat(a.options.pan)||0,d++}),c-d},c.prototype.play=function(){var a,c,d=arguments[0],e=!1;switch(arguments.length){default:case 2:var f=arguments[1];if("object"==typeof f)a=d,c=f,e=!1;else{if("object"!=typeof d)throw"SoundJSDirector.Group.play() given bad arguments";c=d,e=f}break;case 1:switch(typeof d){case"string":a=d;break;case"object":c=d,a=c.id||c.src,e=c.all;break;case"boolean":e=d;break;default:throw"SoundJSDirector.Group.play() given bad arguments"}break;case 0:}var g=b.extend(b.parseOptions(c),this.options);return a?this.playSound(a,g):g.collapsed?this._playCollapsed(g,e):this._playSounds(g,e),this},c.prototype.playSound=function(a,c){var d=this.sounds,e=d[a];return!e&&isNaN(parseInt(a))&&this.eachSound(function(c){return a===c.id||a===c.src?(e=c,b.OUT_EACH):void 0}),e&&this._playSoundWithOptions(e,c),this},c.prototype._playSoundWithOptions=function(a,c){var d={};return b.each(c,function(b,c){switch(c){default:d[c]=b;break;case"pan":d[c]=this.getSoundPan(a,b);break;case"volume":d[c]=this.getSoundVolume(a,b)}},this),a.play(d),this},c.prototype._playSounds=function(a,c){return b.each(c?this.sounds:this._wait,function(b){this._playSoundWithOptions(b,a)},this),this},c.prototype._playCollapsed=function(a,c){var d=b.randomItem(c?this.sounds:this._wait);return d&&this._playSoundWithOptions(d,a),this},c.prototype.pause=function(){return this.eachPlayingSound(function(a){a.pause()}),this},c.prototype.resume=function(){return this.eachPlayingSound(function(a){a.resume()}),this},c.prototype.stop=function(a){switch(arguments.length){case 0:a=null;break;case 1:a instanceof Array||(a=[a]);break;default:a=b.toArray(arguments)}return a&&a.length||(a=null),this.eachPlayingSound(function(b){a&&(a.indexOf(b)<0||a.indexOf(b.src)<0||a.indexOf(b.id)<0)||(b.stop(),b.dispatchEvent("stopped"))}),this},c.prototype.setPosition=function(a){return this.eachPlayingSound(function(b){b.setPosition(a)}),this},c.prototype.seek=c.prototype.setPosition,c.prototype.setVolume=function(a,c){return a=parseFloat(a)||0,this.set("volume",a),b.each(c?this.sounds:this._playing,function(a){a.setVolume(this.getSoundVolume(a))},this),this},c.prototype.getVolume=function(){return this.get("volume")},c.prototype.getSoundVolume=function(a,c){return arguments.length<=1&&(c=b._defaults.volume),b.eachSoundGroup(a,function(a){c*=parseFloat(a.get("volume"))||0}),c};var d=b.OUT_EACH="OUT_EACH";b.each=function(a,b,c){if("function"==typeof b&&a&&"object"==typeof a)if(c=c||null,a instanceof Array)for(var e=a.slice(),f=0,g=e.length;g>f&&d!==b.call(c,e[f],f);f++);else for(var h in a)if(a.hasOwnProperty(h)&&d===b.call(c,a[h],h))break},b.extend=function g(a){var c=b.toArray(arguments,1),d=c.length,e=c[d-1],f=e!==!0;"object"!=typeof a&&(a={}),d||(c[0]=a,d=1,a={});for(var h,i,j,k=0;d>k;k++)if(h=c[k],"object"==typeof h)for(var l in h)i=h[l],j=a[l],!j&&"undefined"==typeof j&&h.hasOwnProperty(l)&&null!==i&&"undefined"!=typeof i&&(a[l]="object"==typeof i&&f&&i!==h?g(i):i);return a},b.randomItem=function(a){if("object"==typeof a){if(a instanceof Array){var b=a.length-1;return a[Math.round(b*Math.random())]}throw"SoundJSDirector.randomItem cannot process objects"}},b.switchCollection=function(a,b,c){for(var d;(d=b.indexOf(a))>=0;)b.splice(d,1);c&&(c[c.length]=a)},b.toArray=function(a){return function(b,c){return a.call(b||[],c||0)}}([].slice);var e={};b.group=function(a){switch(a instanceof b.Group){case!1:return e[a];case!0:return e[a.name]=a}},b.eachSoundGroup=b.prototype.eachSoundGroup=function(a,c){b.each(b.getSoundGroups(a),c)},b.getSoundGroups=b.prototype.getSoundGroups=function(a){return a&&"object"==typeof a?a._groups||function(){var c=a._groups=[];return b.handleSoundsStates(a),c}():[]},b.setSoundGroup=b.prototype.setSoundGroup=function(c,d){if(c&&"object"==typeof c){"string"==typeof d&&(d=b.group(d));var e=b.getSoundGroups(c),f=d.sounds,g=a.Sound;switch(e.push(d),f.push(c),f[c.id||c.src]=c,c.playState){default:case g.PLAY_INITED:case g.PLAY_FAILED:case g.PLAY_FINISHED:case g.PLAY_INTERRUPTED:d._wait.push(c);break;case g.PLAY_SUCCEEDED:d._playing.push(c)}}},b.unsetSoundGroup=b.prototype.unsetSoundGroup=function(a,c){if(a&&"object"==typeof a){"string"==typeof c&&(c=b.group(c));var d=b.getSoundGroups(a),e=c.sounds,f=b.switchCollection;f(c,d),f(a,e),f(a,c._wait),f(a,c._playing);var g=a.id,h=a.src;a===e[g]&&(e[g]=null,delete e[g]),a===e[h]&&(e[h]=null,delete e[h])}},b.handleSoundsStates=function(a){var c=function(c){var d,e;switch(c.type){case"stopped":case"complete":case"failed":case"interrupted":d="_playing",e="_wait";break;case"succeeded":case"loop":d="_wait",e="_playing"}if(d&&e){var f=b.switchCollection;b.eachSoundGroup(a,function(b){f(a,b[d],b[e])})}};a.on("stopped",c),a.on("complete",c),a.on("failed",c),a.on("interrupted",c),a.on("loop",c),a.on("succeeded",c)},b._defaults={volume:1,loop:0,delay:0,offset:0,pan:0,collapsed:!1,basePath:""};var f=Object.keys(b._defaults);b.parseOptions=function(a){var b={};if("object"==typeof a)for(var c,d=f.length;d--;)c=f[d],a.hasOwnProperty(c)&&(b[c]=a[c]);return b}}(window.createjs=window.createjs||{});