/**
 * SoundJS Director v0.1.0
 * Manager for groupped and alone sounds in CreateJS/SoundJS with SoundJSDirector
 * by Vasiliy Os <talk@vasiliy0s.com>
 */
!function(a){"use strict";function b(){throw"SoundJSDirector cannot be initialized. Use 'new SoundJSDirector.Group' for manage sounds"}function c(a,c){var d=arguments.length;if(1===d)switch(typeof a){case"string":c=b.extend(g),c.name=a;break;case"object":c=a,a=c.name}else if(0===d)throw"SoundJSDirector.Group there is no passed arguments";if(!a||"string"!=typeof a)throw"SoundJSDirector.Group cannot initialize new sounds group without name";var e=c.sounds;this.name=a,this.options=b.extend(b.parseOptions(c),g,!0),this.sounds=[],this._playing=[],this._wait=[],e instanceof Array&&this.join(e),b.group(this)}a.SoundJSDirector=b;var d=b.prototype=new a.EventDispatcher;d._sendEvent=function(b){var c=new a.Event(b);this.dispatchEvent(c)},b.Group=b.prototype.Group=c;var e=c.prototype=new a.EventDispatcher;e.add=function(c){var d,e=a.Sound;return c instanceof Array||(c=[c]),b.each(b.toArray(c),function(a){a="object"==typeof a?a:{src:a};var b=e.registerSound(a,a.basePath);if(!b)throw"SoundJSDirector.Group "+this.name+" cannot register sound "+(a.id||a.src);d=e.createInstance(a.id),d&&this.join(d)},this),this},e.join=function(a){return a&&"object"==typeof a&&(a instanceof Array?b.each(a,this.join,this):b.setSoundGroup(a,this)),this},e.leave=function(a){return a instanceof Array?b.each(a,this.leave,this):"object"==typeof a&&b.unsetSoundGroup(a,this),this},e.eachSound=function(a,c){b.each(this.sounds,a,c||null)},e.eachPlayingSound=function(a,c){b.each(this._playing,a,c||null)},e.eachWaitSound=function(a,c){b.each(this._wait,a,c||null)},e.sound=function(a){return this.sounds[a]||null},e.exists=function(a){switch(typeof a){case"object":return this.sounds.indexOf(a)>=0;case"string":return!!this.sounds[a];default:return!1}},e.setLoop=function(a){return this.options.loop=parseInt(a)||0,this},e.switchLoop=function(a){var b=this.options,c=b.loop;return b.loop=0===c?parseInt(a)||-1:0,this},e.setMute=function(a){return this.eachSound(function(b){b.setMute(a)}),this},e.switchMute=function(){return this.eachSound(function(a){a.setMute(!a.getMute())}),this},e.setPan=function(){return this},e.play=function(a,c){return a=b.extend(b.parseOptions(a),this.options),a.collapsed?this._playCollapsed(a,c):this._playSounds(a,c),this},e._playSounds=function(a,c){return b.each(c?this.sounds:this._wait,function(b){b.play(a)}),this},e._playCollapsed=function(a,c){var d=b.randomItem(c?this.sounds:this._wait);return d&&d.play(a),this},e.pause=function(){return this.eachPlayingSound(function(a){a.pause()}),this},e.resume=function(){return this.eachPlayingSound(function(a){a.resume()}),this},e.stop=function(){return this.eachPlayingSound(function(a){a.stop()}),this},e.setPosition=function(a){return this.eachPlayingSound(function(b){b.setPosition(a)}),this},e.setVolume=function(a){var b=b;if(a=parseFloat(a),a===b.volume)return this;var c=this.sounds,d=c.length;if(!d)return this;for(var e,f=d;f--;)e=c[f],e.setVolume(this.getSoundVolume(e));return this},e.getSoundVolume=function(a){var c=a.getVolume()||0;return b.eachSoundGroup(a,function(a){c*=a.options.volume||0}),c},b.each=function(a,b,c){if("function"==typeof b&&a&&"object"==typeof a){var d=a.slice();if(c=c||null,a instanceof Array)for(var e=0,f=d.length;f>e;e++)b.call(c,d[e],e);else for(var g in a)a.hasOwnProperty(g)&&b.call(c,d[g],g)}},b.extend=function i(a){var c=b.toArray(arguments,1),d=c.length,e=c[d-1],f=e!==!0;"object"!=typeof a&&(a={}),d||(c[0]=a,d=1,a={});for(var g,h,j,k=0;d>k;k++)if(g=c[k],"object"==typeof g)for(var l in g)h=g[l],j=a[l],!j&&"undefined"==typeof j&&g.hasOwnProperty(l)&&null!==h&&"undefined"!=typeof h&&(a[l]="object"==typeof h&&f&&h!==g?i(h):h);return a},b.randomItem=function(a){if("object"==typeof a){if(a instanceof Array){var b=a.length-1;return a[Math.round(b*Math.random())]}throw"SoundJSDirector.randomItem cannot process objects"}},b.switchCollection=function(a,b,c){for(var d;(d=b.indexOf(a))>=0;)b.splice(d,1);c&&(c[c.length]=a)},b.toArray=function(a){return function(b,c){return a.call(b||[],c||0)}}([].slice);var f={};b.group=function(a){switch(a instanceof b.Group){case!1:return f[a];case!0:return f[a.name]=a}},b.eachSoundGroup=b.prototype.eachSoundGroup=function(a,c){b.each(b.getSoundGroups(a),c)},b.getSoundGroups=b.prototype.getSoundGroups=function(a){return a&&"object"==typeof a?a._groups||function(){var c=a._groups=[];return b.handleSoundsStates(a),c}():[]},b.setSoundGroup=b.prototype.setSoundGroup=function(c,d){if(c&&"object"==typeof c){"string"==typeof d&&(d=b.group(d));var e=b.getSoundGroups(c),f=d.sounds,g=a.Sound;switch(e.push(d),f.push(c),f[c.id||c.src]=c,c.playState){default:case g.PLAY_INITED:case g.PLAY_FAILED:case g.PLAY_FINISHED:case g.PLAY_INTERRUPTED:d._wait.push(c);break;case g.PLAY_SUCCEEDED:d._playing.push(c)}}},b.unsetSoundGroup=b.prototype.unsetSoundGroup=function(a,c){if(a&&"object"==typeof a){"string"==typeof c&&(c=b.group(c));var d=b.getSoundGroups(a),e=c.sounds,f=b.switchCollection;f(c,d),f(a,e),f(a,c._wait),f(a,c._playing);var g=a.id,h=a.src;a===e[g]&&(e[g]=null,delete e[g]),a===e[h]&&(e[h]=null,delete e[h])}},b.handleSoundsStates=function(a){var c=function(c){var d,e;switch(c.type){case"complete":case"failed":case"interrupted":d="_playing",e="_wait";break;case"succeeded":case"loop":d="_wait",e="_playing"}var f=b.switchCollection;b.eachSoundGroup(a,function(b){f(a,b[d],b[e])})};a.on("complete",c),a.on("failed",c),a.on("interrupted",c),a.on("loop",c),a.on("succeeded",c)};var g={volume:1,loop:0,delay:0,offset:0,pan:0,collapsed:!1},h=Object.keys(g);b.parseOptions=function(a){var b={};if("object"==typeof a)for(var c,d=h.length;d--;)c=h[d],a.hasOwnProperty(c)&&(b[c]=a[c]);return b}}(window.createjs=window.createjs||{});